---
description: Use when creating a new file
globs:
alwaysApply: true
---

## General Guidelines

### Code Style:
- Use descriptive variable and function names
- Add comprehensive documentation comments
- Follow Swift naming conventions
- Use `public` visibility for API classes
- Use `private` for implementation details
- Use `Tensor.Scalar` typealias instead of hardcoding `Float` for any new functions that need access to a scalar type. This ensures compatibility with Float16 quantization (when `QUANTIZED_F16` flag is set). See `TensorSIMD.swift` for examples.
- Any new math functions on a Tensor should be implemented for both `Float` and `Float16` types to ensure the framework works correctly with or without quantization enabled.

### Error Handling:
- Validate input dimensions and parameters
- Provide meaningful error messages

### Testing:
- Create unit tests for new components
- Test with different input sizes and batch sizes
- Verify gradient computations are correct
- Test serialization/deserialization

### Performance:
- Use NumSwift operations for mathematical computations
- Minimize memory allocations in forward passes and hot loops
- Consider GPU compatibility when implementing operations